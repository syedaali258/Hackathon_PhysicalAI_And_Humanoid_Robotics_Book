# Data Model: AI/Spec-Driven Book using Docusaurus

**Feature**: AI-native book on Physical AI & Humanoid Robotics with embedded RAG chatbot
**Branch**: 004-vla-module
**Date**: 2025-12-24

## Overview

This document defines the data models for the AI-native book on Physical AI & Humanoid Robotics. The system includes content management, user interaction, and RAG chatbot components with strict zero hallucination constraints.

## Core Data Models

### 1. Content Models

#### Document
- **id**: string (primary key)
- **title**: string (required)
- **content**: string (required, markdown format)
- **module**: string (e.g., "module-1-ros2", "module-4-vla")
- **chapter**: string (e.g., "chapter-1-fundamentals")
- **version**: string (semantic versioning)
- **author**: string
- **created_at**: datetime
- **updated_at**: datetime
- **tags**: array of strings
- **references**: array of Reference objects
- **validation_status**: enum ["pending", "verified", "invalid"]
- **source_url**: string (optional, for official documentation references)

**Validation Rules**:
- Title must be 1-200 characters
- Content must be valid markdown
- Module and chapter must follow naming convention
- References must be valid citations

#### Reference
- **id**: string (primary key)
- **title**: string (required)
- **url**: string (required, valid URL)
- **type**: enum ["documentation", "research_paper", "tutorial", "api_reference"]
- **source**: string (e.g., "ROS 2 Official Docs", "NVIDIA Isaac Docs")
- **access_date**: datetime
- **verified**: boolean (default: false)

**Validation Rules**:
- URL must be accessible and return valid content
- Type must be one of the defined enum values
- Source must be from official documentation

### 2. Chat Interaction Models

#### ChatSession
- **id**: string (primary key, UUID)
- **user_id**: string (optional, for registered users)
- **created_at**: datetime
- **updated_at**: datetime
- **status**: enum ["active", "ended", "archived"]
- **module_context**: string (optional, current module being discussed)
- **conversation_history**: array of Message objects

**Validation Rules**:
- Status must be one of the defined enum values
- Module context must be valid if provided
- Conversation history length limited to prevent memory issues

#### Message
- **id**: string (primary key, UUID)
- **session_id**: string (foreign key to ChatSession)
- **role**: enum ["user", "assistant"]
- **content**: string (required)
- **timestamp**: datetime
- **sources**: array of string (document IDs that informed the response)
- **confidence**: number (0-1, for RAG responses)
- **is_from_content**: boolean (true if response is based only on book content)

**Validation Rules**:
- Role must be either "user" or "assistant"
- Content must be 1-10000 characters
- Sources must be valid document IDs if provided
- Confidence must be between 0 and 1 if provided

### 3. VLA (Vision-Language-Action) Models

#### VoiceCommand
- **id**: string (primary key, UUID)
- **audio_data**: string (base64 encoded audio data, optional if text provided)
- **transcribed_text**: string (required if audio_data not provided)
- **timestamp**: datetime
- **confidence**: number (0-1, speech recognition confidence)
- **user_id**: string (optional)
- **session_id**: string (optional, for grouping related commands)

**Validation Rules**:
- Either audio_data or transcribed_text must be provided
- Confidence must be between 0 and 1 if provided

#### LanguagePlan
- **id**: string (primary key, UUID)
- **command_id**: string (foreign key to VoiceCommand)
- **interpreted_meaning**: string (required)
- **action_sequence**: array of ActionStep objects
- **generated_by_llm**: string (model identifier)
- **timestamp**: datetime
- **execution_context**: object (environment state for planning)

**Validation Rules**:
- Action sequence must contain at least one valid action step
- Generated by LLM must be a recognized model identifier

#### ActionStep
- **action_type**: string (required, e.g., "move_forward", "turn_left", "navigate_to")
- **parameters**: object (action-specific parameters)
- **description**: string (human-readable description)
- **estimated_duration_ms**: number (optional, estimated execution time)

**Validation Rules**:
- Action type must be one of the supported VLA action types
- Parameters must match the requirements for the action type

#### RobotAction
- **id**: string (primary key, UUID)
- **action_type**: string (required, e.g., "move_forward", "raise_arm", "grasp_object")
- **parameters**: object (action-specific parameters)
- **execution_priority**: number (default: 0)
- **estimated_duration_ms**: number (optional)
- **plan_id**: string (optional, foreign key to LanguagePlan)

**Validation Rules**:
- Action type must be one of the supported robot action types
- Parameters must be valid for the action type

#### SimulationEnvironment
- **id**: string (primary key, UUID)
- **name**: string (required)
- **description**: string
- **objects**: array of ObjectInEnvironment objects
- **spatial_info**: object (coordinates, bounds, etc.)
- **timestamp**: datetime

**Validation Rules**:
- Name must be 1-100 characters
- Spatial info must contain valid coordinate system data

#### ObjectInEnvironment
- **name**: string (required)
- **type**: string (e.g., "cup", "ball", "table")
- **position**: object (x, y, z coordinates)
- **properties**: object (color, size, etc.)

**Validation Rules**:
- Position must contain valid 3D coordinates
- Type must be one of the supported object types

### 4. User and Session Models

#### UserSession
- **id**: string (primary key, UUID)
- **user_id**: string (optional, for registered users)
- **session_type**: enum ["chat", "content_reading", "vla_interaction"]
- **start_time**: datetime
- **end_time**: datetime (optional)
- **active_module**: string (current module)
- **progress**: object (module-specific progress tracking)

**Validation Rules**:
- Session type must be one of the defined enum values
- Start time must be before end time if end time provided

## State Transitions

### ChatSession States
```
PENDING → ACTIVE → ENDED → ARCHIVED
   ↑                        ↓
   └────────────────────────┘ (timeout/archive)
```

### Document Validation States
```
PENDING → VERIFIED
   ↓
INVALID (if verification fails)
```

## Relationships

### Content Relationships
- Document → Reference (one-to-many)
- Document → ChatMessage (through sources)

### Chat Relationships
- ChatSession → Message (one-to-many)
- Message → Document (many-to-many through sources)

### VLA Relationships
- VoiceCommand → LanguagePlan (one-to-one)
- LanguagePlan → ActionStep (one-to-many)
- LanguagePlan → RobotAction (one-to-many)
- SimulationEnvironment → ObjectInEnvironment (one-to-many)

## Validation Rules Summary

### Content Validation
- All content must be sourced from official documentation
- References must be verifiable and accessible
- Document versioning follows semantic versioning
- Content updates require re-validation

### Chat Validation
- All assistant responses must be based only on book content (zero hallucination)
- User inputs are sanitized to prevent injection
- Session timeouts prevent resource exhaustion

### VLA Validation
- Action sequences must be executable in simulation
- Environment state is validated before action execution
- Safety constraints are enforced during planning

## Indexing Strategy

### Primary Indexes
- Document.id (primary)
- ChatSession.id (primary)
- Message.id (primary)
- VoiceCommand.id (primary)

### Secondary Indexes
- Document.module, Document.chapter (for navigation)
- ChatSession.user_id (for user-specific sessions)
- Message.session_id (for conversation retrieval)
- Document.tags (for content discovery)
- Message.timestamp (for chronological ordering)

This data model supports the zero hallucination requirement by maintaining clear provenance of all content and ensuring that chat responses are tied to verified source documents.